<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Hardening the USB Armory (part 1) | r1cebank's code &amp; üçó</title><meta name="keywords" content="linux,security,luks,usbarmory"><meta name="author" content="r1cebank,rbnk@elica.io"><meta name="copyright" content="r1cebank"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Since last time I wrote about the USB Armory II, I have spent a considerable amount of time working on the device. I have to say it is a very capable device, able to support many tools that I want to">
<meta property="og:type" content="article">
<meta property="og:title" content="Hardening the USB Armory (part 1)">
<meta property="og:url" content="https://r1ce.net/2021/02/27/hardening-usb-armory-1/index.html">
<meta property="og:site_name" content="r1cebank&#39;s code &amp; üçó">
<meta property="og:description" content="Since last time I wrote about the USB Armory II, I have spent a considerable amount of time working on the device. I have to say it is a very capable device, able to support many tools that I want to">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://r1ce.net/covers/usbarmorymkii.webp">
<meta property="article:published_time" content="2021-02-27T07:00:32.000Z">
<meta property="article:modified_time" content="2022-02-27T01:22:42.321Z">
<meta property="article:author" content="r1cebank">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="security">
<meta property="article:tag" content="luks">
<meta property="article:tag" content="usbarmory">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://r1ce.net/covers/usbarmorymkii.webp"><link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/261671"><link rel="canonical" href="https://r1ce.net/2021/02/27/hardening-usb-armory-1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.clarity.ms"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>(function(c,l,a,r,i,t,y){
    c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
    t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
    y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
})(window, document, "clarity", "script", "9k4dnvks84");</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hardening the USB Armory (part 1)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-02-26 17:22:42'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/261671" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">25</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">14</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/Food"><i class="fa-fw fas fa-drumstick-bite"></i><span> Food</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/covers/usbarmorymkii.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">r1cebank's code &amp; üçó</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/Food"><i class="fa-fw fas fa-drumstick-bite"></i><span> Food</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Hardening the USB Armory (part 1)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-02-27T07:00:32.000Z" title="Created 2021-02-26 23:00:32">2021-02-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-02-27T01:22:42.321Z" title="Updated 2022-02-26 17:22:42">2022-02-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Technology/">Technology</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Technology/Tutorials/">Tutorials</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Hardening the USB Armory (part 1)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Since last time I wrote about the USB Armory II, I have spent a considerable amount of time working on the device. I have to say it is a very capable device, able to support many tools that I want to run on it. But working with USB Armory with Secure Boot turned on, I have found some issues that is not documented in the wiki.</p>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>The secure boot process will only protect the initial boot process, validating the kernel, but its still easy to modify the filesystem and inject files in to the filesystem. The rootfs is also not encrypted so the content is not safe, if you store a LUKS key to use for auto unlock encrypted partition it can be exposed.</p>
<h2 id="‚ÄòKinda-ok‚Äô-solution"><a href="#‚ÄòKinda-ok‚Äô-solution" class="headerlink" title="‚ÄòKinda ok‚Äô solution"></a>‚ÄòKinda ok‚Äô solution</h2><p>The first step is to use LUKS to encrypt the SD card and since I use it to store files required to various service at start up, I need to setup auto unlock when the system boots up. But since the rootfs is not encrypted, storing the key inside the rootfs is not making it more secure, anyone know how to read a crypttab will be able to locate the keyfile and unlock the drive. Because the device included a crypto processor with sealed keys, another approach to make this work is to store the encrypted keys on the drive and during mount, call the crypto processor to decrypt it and unlock the drive. </p>
<p>But remember anyone is able to mount and tamper with our rootfs right? They can just easily slip a script for it to be ran at startup and call the crypto processor, decrypt the keys, and dump the decrypted keys to the rootfs.</p>
<h2 id="The-solution"><a href="#The-solution" class="headerlink" title="The solution"></a>The solution</h2><p>Since we already have secure boot, the rest of the task to ensure security of the device lies with if we can lock down the rootfs. If we are able to use LUKS to encrypt the partition and use kernel + initramfs to validate and unlock the drive. We are able to prevent regular-skilled attack on the device. Because they are not able to bypass secureboot and install their own initramfs and kernel, they cannot tamper with the LUKS unlock sequence and if we store encrypted password there and use DCP to decrypt and unlock LUKS we are able to prevent any tamper to the unlock sequence to dump the password. To add an extra layer of security we can also enable boot ssh unlock using dropbear, then no key is stored on the device encrypted or plaintext, hence prevent unlock even if the device is lost and attacker figured out a way to decrypt the embedded encrypted keys.</p>
<p>Example using dcp_derive to feed decrypted keys to cryptsetup to unlock the partition.</p>
<pre><code>#!/bin/sh

/usr/bin/dcp_derive dec $(cat /etc/dcp_pass) 27 | cryptsetup luksOpen /dev/mmcblk0p1 mmc0_crypt -d -

mount /dev/mapper/mmc0_crypt /mnt/secure
</code></pre>
<h2 id="Is-it-it-possible"><a href="#Is-it-it-possible" class="headerlink" title="Is it it possible?"></a>Is it it possible?</h2><p>I asked about this in the google group for USB Armory and I got an response from one of the developers.</p>
<img src="/2021/02/27/hardening-usb-armory-1/image-10.png" class="" title="developer response">
<p>So it appears that it is totally possible to do this, its going to be complicated, but its possible.</p>
<p>They didn‚Äôt provide me with any more information on how to achieve this but I guessed it would be the following:</p>
<ul>
<li>Enable Secure Boot with U-boot or armory-boot (armory-boot doesn‚Äôt support initramfs, so we probably have to stick with u-boot)</li>
<li>Have the signed bootloader to verify kernel image + initramfs</li>
<li>Initramfs will run init first to decrypt the LUKS roofs and run root_switch after</li>
</ul>
<p>I am going to try to test with another usbarmory with u-boot (if I am not able to make armory-boot to support initramfs)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/r1cebank">r1cebank</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://r1ce.net/2021/02/27/hardening-usb-armory-1/">https://r1ce.net/2021/02/27/hardening-usb-armory-1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/linux/">linux</a><a class="post-meta__tags" href="/tags/security/">security</a><a class="post-meta__tags" href="/tags/luks/">luks</a><a class="post-meta__tags" href="/tags/usbarmory/">usbarmory</a></div><div class="post_share"><div class="social-share" data-image="/covers/usbarmorymkii.webp" data-sites="facebook,twitter,weibo,qq, linkedin, wechat, qzone"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/03/03/using-bitwarden/"><img class="prev-cover" src="/covers/bitwarden.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Using Bitwarden as password manager</div></div></a></div><div class="next-post pull-right"><a href="/2021/02/22/usbarmory-ii/"><img class="next-cover" src="/covers/usbarmorymkii.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">USB Armory II</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2021/03/17/hardening-usb-armory-2/" title="Hardening the USB Armory (part 2)"><img class="cover" src="/covers/usbarmorymkiilayout.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-16</div><div class="title">Hardening the USB Armory (part 2)</div></div></a></div><div><a href="/2021/02/01/creating-luks-from-existing/" title="Creating luks partition from existing partition"><img class="cover" src="/covers/luks.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-01</div><div class="title">Creating luks partition from existing partition</div></div></a></div><div><a href="/2021/02/22/usbarmory-ii/" title="USB Armory II"><img class="cover" src="/covers/usbarmorymkii.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-22</div><div class="title">USB Armory II</div></div></a></div><div><a href="/2018/04/24/adapta-theme/" title="Adapta Theme Review"><img class="cover" src="/covers/adapta-theme.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-04-24</div><div class="title">Adapta Theme Review</div></div></a></div><div><a href="/2020/07/07/arch-installer-alis/" title="Arch installer - alis"><img class="cover" src="/covers/archlinux.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-06</div><div class="title">Arch installer - alis</div></div></a></div><div><a href="/2021/01/11/docker-ufw/" title="Using docker with ufw"><img class="cover" src="/covers/docker-ufw.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-11</div><div class="title">Using docker with ufw</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/261671" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">r1cebank</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">25</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">22</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">14</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/r1cebank"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/r1cebank" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:rbnk@elica.io" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">Welcome to my blog, this is where I record learnings and write about random stuff. Enjoy ‚ù§Ô∏è<br> ÊóßÂçöÂÆ¢ÂÜÖÂÆπÂØºÂÖ•ÂÆåÊàêÔºå‰ºöÊó∂‰∏çÊó∂ÁöÑÊõ¥Êñ∞Êñ∞ÂÜÖÂÆπ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem"><span class="toc-number">1.</span> <span class="toc-text">Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%80%98Kinda-ok%E2%80%99-solution"><span class="toc-number">2.</span> <span class="toc-text">‚ÄòKinda ok‚Äô solution</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-solution"><span class="toc-number">3.</span> <span class="toc-text">The solution</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Is-it-it-possible"><span class="toc-number">4.</span> <span class="toc-text">Is it it possible?</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/02/27/food-plan/" title="Âú®ÂÆ∂Â∑•‰ΩúÁÆÄÂçïÈ£üË∞±"><img src="/covers/food-recipe-4.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Âú®ÂÆ∂Â∑•‰ΩúÁÆÄÂçïÈ£üË∞±"/></a><div class="content"><a class="title" href="/2022/02/27/food-plan/" title="Âú®ÂÆ∂Â∑•‰ΩúÁÆÄÂçïÈ£üË∞±">Âú®ÂÆ∂Â∑•‰ΩúÁÆÄÂçïÈ£üË∞±</a><time datetime="2022-02-27T00:36:16.000Z" title="Created 2022-02-26 16:36:16">2022-02-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/20/mystery-console-1/" title="Á•ûÁßòÁöÑÊ∏∏ÊàèÊú∫ (part 1)"><img src="/covers/mystery-console-1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Á•ûÁßòÁöÑÊ∏∏ÊàèÊú∫ (part 1)"/></a><div class="content"><a class="title" href="/2022/01/20/mystery-console-1/" title="Á•ûÁßòÁöÑÊ∏∏ÊàèÊú∫ (part 1)">Á•ûÁßòÁöÑÊ∏∏ÊàèÊú∫ (part 1)</a><time datetime="2022-01-20T23:16:53.000Z" title="Created 2022-01-20 15:16:53">2022-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/03/year-review-2021/" title="2021 Review"><img src="/covers/review-3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 Review"/></a><div class="content"><a class="title" href="/2022/01/03/year-review-2021/" title="2021 Review">2021 Review</a><time datetime="2022-01-03T00:09:36.000Z" title="Created 2022-01-02 16:09:36">2022-01-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/19/beef-stock-1/" title="Beef stock recipe"><img src="/covers/food-recipe-3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Beef stock recipe"/></a><div class="content"><a class="title" href="/2021/12/19/beef-stock-1/" title="Beef stock recipe">Beef stock recipe</a><time datetime="2021-12-19T21:26:44.000Z" title="Created 2021-12-19 13:26:44">2021-12-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/17/hardening-usb-armory-2/" title="Hardening the USB Armory (part 2)"><img src="/covers/usbarmorymkiilayout.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hardening the USB Armory (part 2)"/></a><div class="content"><a class="title" href="/2021/03/17/hardening-usb-armory-2/" title="Hardening the USB Armory (part 2)">Hardening the USB Armory (part 2)</a><time datetime="2021-03-17T05:26:15.000Z" title="Created 2021-03-16 22:26:15">2021-03-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By r1cebank</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Made with ‚ù§Ô∏è in Vancouver</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? '' : ''

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>